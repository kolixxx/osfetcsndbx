<?xml version="1.0" encoding="UTF-8"?>
<!--
  Suricata filestore -> Cuckoo Sandbox daemon configuration.
  OPNsense: Suricata file-extraction writes to filestore; this daemon
  watches for new files and submits them to Cuckoo API.
-->
<cuckoomx>
  <filestore>
    <!-- Base directory of Suricata filestore (subdirs 00..ff) -->
    <path>/var/log/suricata/filestore</path>
    <!-- Watch method: kqueue (best on FreeBSD/OPNsense, requires p5-IO-KQueue), inotify (Linux), or polling -->
    <!-- Note: p5-IO-KQueue usually not available in OPNsense repos, so polling is default -->
    <watch-method>polling</watch-method>
    <!-- Polling interval in seconds (used when watch-method is "polling") -->
    <poll-interval>5</poll-interval>
    <!-- Seconds to wait after a file appears before submitting (allow Suricata to finish writing) -->
    <file-settle-time>2</file-settle-time>
  </filestore>

  <cuckoo>
    <api-url>http://127.0.0.1:8090</api-url>
    <api-token></api-token>
    <guest>Cuckoo1</guest>
  </cuckoo>

  <logging>
    <syslogfacility>daemon</syslogfacility>
  </logging>
</cuckoomx>
